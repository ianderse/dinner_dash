<div id="masonry-grid">
  <div class="grid-sizer">
    <% @items.each do |item| %>
      <div class="grid-item <%= item.categories.reduce('') { |sum, category| sum + category.title.tr(' ','_') + ' '}.strip %>">
        <%= image_tag item.image.url(:medium) if item.image_file_name %><br/>
        <%= link_to item.title, item_path(item) %><br/>
        <%= item.description %>
        <%= print_price(item.price) %><br/>
        <%= form_tag(cart_add_item_path(item), method: :patch, remote: true) do %>
          <span class="glyphicon glyphicon-plus"></span>
          <%= label_tag "quantity" %>
          <%= number_field_tag "quantity", 1 %>
          <%= submit_tag 'Add to cart', class: "btn btn-default btn-sm", id: "add_to_cart" %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

<script>
  var container = document.querySelector('#masonry-grid');
  var msnry = new Masonry( container, {
    columnWidth: ".grid-sizer",
    itemSelector: '.grid-item'
  });
  imagesLoaded( container, function() {
    msnry.layout();
  });
</script>
